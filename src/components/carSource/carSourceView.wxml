<import src="../../components/common/price/quotedPriceView.wxml" />
<import src="../../components/common/specifications/carColorView.wxml" />
<import src="../../components/common/supplier/supplierNameView.wxml" />

<template name="carSourceView">
  <view class="car-source-cell">
    <!-- 头部选择部分 -->
    <view wx:if="{{carSourceItem.viewModelTabs || carSourceItem.viewModelTabMore}}" class="header">
      <view class="tab {{carSourceItem.viewModelSelectedTab == index ? 'selected' : ''}}" wx:for="{{carSourceItem.viewModelTabs}}"
        wx:key="{{ index }}" bindtap="handlerCarSourceTabClick" data-tab-item="{{item}}" data-tab-item-index="{{index}}" data-sku-index="{{skuItemIndex}}"
        data-car-source-index="{{carSourceItemIndex}}">
        {{item.name}}
        <image src="/images/icons/icon_triangle_nav.png"></image>
      </view>
      <view wx:if="{{carSourceItem.viewModelTabMore.length}}" class="tab {{carSourceItem.viewModelSelectedTab == -1 ? 'selected' : ''}}"
        bindtap="handlerCarSourceMore" data-sku-index="{{skuItemIndex}}" data-car-source-index="{{carSourceItemIndex}}">
        更多
        <image src="/images/icons/icon_triangle_nav.png"></image>
      </view>
    </view>

    <view class="body">
      <!-- 第一部分 -供应商名称 + 渠道来源-->
      <view class="first-part">
        <!-- 供应商名称 -->
        <view class="first-first-part">
          <template is="supplierNameView" data="{{ supplier: carSourceItem.supplier, supplierSelfSupport: carSourceItem.supplierSelfSupport, skuItemIndex, carSourceItemIndex }}"/>
        </view>

        <!-- 货源渠道信息 -->
        <view wx:if="{{!carSourceItem.supplierSelfSupport}}" class="carSource-channel">
          <view class="publish-date">
            {{carSourceItem.viewModelPublishDateDesc}}
          </view>
          <!--朋友圈信息暂时去掉-->
          <!--<image-->
          <!--wx:if="{{carSourceItem.publishChannel === '微信朋友圈'}}"-->
          <!--src="/images/icons/icon_source_moments.png"-->
          <!--&gt;-->
          <!--</image>-->
          <!--<image-->
          <!--wx:if="{{carSourceItem.publishChannel === '微信群'}}"-->
          <!--src="/images/icons/icon_source_wechat.png"-->
          <!--&gt;-->
          <!--</image>-->
        </view>
      </view>

      <view wx:if="{{carSourceItem.viewModelSelectedTab == -1}}" class="more">
        <!--更多选项卡-->
        <view wx:for="{{carSourceItem.viewModelTabMore}}" wx:key="{{ carSourcePlaceItemIndex }}" wx:for-item="carSourcePlaceItem" wx:for-index="carSourcePlaceItemIndex"
          wx:if="{{carSourcePlaceItemIndex % 2 === 0}}" class="line">
          <!--左边-->
          <view wx:if="{{carSourcePlaceItemIndex % 2 === 0}}" bindtap="handlerCarSourceDetail" data-sku-index="{{skuItemIndex}}" data-car-source="{{carSourceItem}}"
            data-car-source-index="{{carSourceItemIndex}}" data-car-source-place="{{carSourcePlaceItem}}" data-car-source-place-index="{{carSourcePlaceItemIndex}}"
            class="item">
            <view class="carSources-place"> {{carSourcePlaceItem.name}}货源 </view>
            <template is="quotedPriceView" data="{{ ...carSourcePlaceItem.viewModelQuoted }}" />
          </view>

          <view wx:if="{{(carSourcePlaceItemIndex % 2 === 0) && carSourceItem.viewModelTabMore[carSourcePlaceItemIndex + 1]}}" bindtap="handlerCarSourceDetail"
            data-sku-index="{{skuItemIndex}}" data-car-source-index="{{carSourceItemIndex}}" data-car-source-place="{{carSourceItem.viewModelTabMore[carSourcePlaceItemIndex + 1]}}"
            data-car-source-place-index="{{carSourcePlaceItemIndex + 1}}" class="item">
            <!--右边-->
            <view class="carSources-place">{{carSourceItem.viewModelTabMore[carSourcePlaceItemIndex + 1].name}}货源 </view>
            <template is="quotedPriceView" data="{{ ...carSourceItem.viewModelTabMore[carSourcePlaceItemIndex + 1].viewModelQuoted }}" />
          </view>
        </view>
      </view>
      <view wx:else bindtap="onCarSourceCellClick" data-sku-index="{{skuItemIndex}}" data-car-source-index="{{carSourceItemIndex}}"
        class="normal-part">
        <!--最近，最便宜-->
        <view class="second-part">
          <!-- 车源基本信息 -->
          <view class="basic-infomation">
            <view class="basic-label">
              <template is="carColorView" data="{{ externalColorName: carSourceItem.externalColor, internalColorName: carSourceItem.viewModelInternalColor }}" />
            </view>
            <view wx:if="{{carSourceItem.storeInsurance}}" class="basic-label">店保</view>
            <view wx:if="{{carSourceItem.sourceRegionsDesc && carSourceItem.sourceRegionsDesc.length}}" class="basic-label">{{carSourceItem.sourceRegionsDesc}}</view>
            <view wx:if="{{carSourceItem.salableRegionsDesc && carSourceItem.salableRegionsDesc.length}}" class="basic-label">{{carSourceItem.salableRegionsDesc}}</view>
          </view>
          <!-- 供货价格 -->
          <block wx:if="{{carSourceItem.viewModelSelectedCarSourcePlace.viewModelEqualWithOfficialPrice}}">
            <view class="price-tips-small">价格电议</view>
          </block>
          <block wx:else>
            <template is="quotedPriceView" data="{{ ...carSourceItem.viewModelSelectedCarSourcePlace.viewModelQuoted }}" />
          </block>
        </view>

        <!-- 第二部分 物流信息 -->
        <view class="third-part">
          <view class="detail-look">详情／生成报价>></view>
          <view wx:if="{{ carSourceItem.viewModelSelectedCarSourcePlace.viewModelSelectedLogisticsDestination }}" class="logistics-information">
            <view class="logistics">
              <view wx:if="{{carSourceItem.viewModelSelectedCarSourcePlace.logisticsFree}}" class="logistics-free">
                <block wx:if="{{carSourceItem.viewModelSelectedCarSourcePlace.viewModelSelectedLogisticsDestination.destType === 'store'}}">
                  包邮到门店
                </block>
                <block wx:if="{{carSourceItem.viewModelSelectedCarSourcePlace.viewModelSelectedLogisticsDestination.destType === 'station'}}">
                  包邮到驿站
                </block>
                <block wx:if="{{carSourceItem.viewModelSelectedCarSourcePlace.viewModelSelectedLogisticsDestination.destType === 'mainline'}}">
                  干线自提
                </block>
              </view>
              <view wx:else class="logistics-none-free">
                <view>
                  运费约: {{ carSourceItem.viewModelSelectedCarSourcePlace.viewModelSelectedLogisticsDestination.viewModelLogisticsFeeDesc }}
                </view>
              </view>
              <view class="logistics-date">
                {{ carSourceItem.viewModelSelectedCarSourcePlace.viewModelExpectedDeliveryDaysDesc }}
              </view>
            </view>
          </view>
          <view wx:else>
          </view>
          <view wx:if="{{carSourceItem.viewModelSelectedCarSourcePlace.logisticsFree}}" class="logistics-information-tips">
            (含运费)
          </view>
          <view wx:else>
            <view wx:if="{{carSourceItem.viewModelSelectedCarSourcePlace.viewModelEqualWithOfficialPrice}}">
              <!--为空-->
            </view>
            <view wx:else class="bare-price">
              裸车价
            </view>
          </view>
        </view>

        <!-- 第三部分 标签 -->
        <view wx:if="{{carSourceItem.viewModelSelectedCarSourcePlace.viewModelTags.length > 0}}" class="forth-part">
          <view class="tag-collection">
            <view wx:for="{{carSourceItem.viewModelSelectedCarSourcePlace.viewModelTags}}" wx:key="{{ index }}" class="tag">
              {{item}}
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
</template>
